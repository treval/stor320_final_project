# Train vs. test set
```{r}
# there are n observations
n <- dim(hour)[1]
# number of observations that go in the training st
n_tr <- floor(n * .8)
# randomly select n_tr numbers, without replacement, from 1...n
tr_indices <- sample(x=1:n, size=n_tr, replace=FALSE)
# break the data into a non-overlapping train and test set
train <- hour[tr_indices, ]
test <- hour[-tr_indices, ]
```
# Fit a bunch of models
```{r}
# manually add hr^2 to the data matrix
train_square <- mutate(train, hr_sq = hr^2)
model_square <- lm(cnt ~ hr + hr_sq, train_square)
# there is a better way to do this using R's modeling language
model_square <- lm(cnt ~ hr + I(hr^2), train)
```
# Let's do this automatically
```{r}
# largest degree polynomial to try
d_max <- 20
# lets save each model we fit in a list
models <- list()
# also store the traing error in data frame
error <- tibble(degree=1:d_max,
MSE_tr = rep(0, d_max))
# fit all the models
for(d in 1:d_max){
# the poly function does exactly what you think it does
models[[d]] <- lm(cnt ~ poly(hr, d), train)
# compute the MSE for the training data
mse_tr <- mean(models[[d]]$residuals^2)
# save the MSE
error[d, 'MSE_tr'] <- mse_tr
}
#link for orthogonal polynomials versus raw in R: https://stackoverflow.com/questions/29999900/poly-in-lm-difference-between-raw-vs-orthogonal/30000214#30000214?newreg=2f561c21931544f99ccdda26b8f24f6a
error
```
# Training error
```{r}
# plot the training error
ggplot(error)+
geom_point(aes(x=degree, y=MSE_tr)) +
geom_line(aes(x=degree, y=MSE_tr))
```
# Degree 20 model
```{r, echo=F}
model_20 <- models[[20]]
# get the predictions at each hour
pred <- tibble(hr=0:23)
hr_predictions <- predict(model_20, newdata = pred)
pred <- pred %>%
mutate(cnt_pred =hr_predictions)
# plot the predictions over the training data
ggplot(data=train)+
geom_point(aes(x=hr, y=cnt)) +
geom_line(data=pred, aes(x=hr, y=cnt_pred), color='red')
```
# Test error
```{r, echo=F}
# lets add the test error to the error data frame
error <- error %>%
add_column(MSE_tst=rep(0, d_max))
for(d in 1:d_max){
# grab the trained model
model <- models[[d]]
# get the predictions for the test data, compute the residuals
test_results <- test %>%
mutate(hr_pred = predict(model, newdata=test)) %>%
#mutate(resid_sq = (hr-hr_pred)^2)
mutate(resid_sq = (cnt-hr_pred)^2)
# compute the MSE
#    mst_tst <- summarise(test_results, mse_tst = #mean(resid_sq))[[1]]
mst_tst <- mean(test_results$resid_sq)
error[d, 'MSE_tst'] <- mst_tst
}
ggplot(error)+
geom_point(aes(x=degree, y=MSE_tst)) +
geom_line(aes(x=degree, y=MSE_tst))
```
# Train vs test
```{r}
error %>%
rename(tr=MSE_tr, tst=MSE_tst) %>%
gather(key=type, value=error, tr, tst) %>%
ggplot() +
geom_point(aes(x=degree, y=log10(error), color=type)) +
geom_line(aes(x=degree, y=log10(error), color=type))
```
m <- lm(cnt ~ poly(hr, 5), train)
summary(m)
m <- lm(cnt ~ poly(hr, 20), train)
summary(m)
m <- lm(cnt ~ poly(hr, 50), train)
hour11 <- read_csv('https://raw.githubusercontent.com/idc9/stor390/master/data/bikes_2011.csv')
---
title: "Analysis 3 EDA"
author: "Trevor Levey"
date: "11/11/2017"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# data from 2011
hour11 <- read_csv('https://raw.githubusercontent.com/idc9/stor390/master/data/bikes_2011.csv')
```
####Exploring the workingday variable
```{r}
ggplot(data = hour11) +
geom_boxplot(mapping = aes(x=factor(workingday), y=cnt))
is_wd <- hour11[hour11$workingday==1,]$cnt
not_wd <- hour11[!hour11$workingday==1,]$cnt
t.test(x=is_wd, y=not_wd)
#RESULT: Probably not great measure.
```
####Looking at temp variable
```{r}
ggplot(data = hour11) +
geom_hex(mapping=aes(x=temp, y=cnt))
ggplot(data = hour11 %>% filter(cnt<200)) +
geom_jitter(mapping=aes(x=temp, y=cnt))
#RESULT: Definitely something going on. Still densest below 200
```
####Looking at wind speed variable
```{r}
ggplot(data = hour11) +
geom_histogram(mapping=aes(x=windspeed), bins=30)
ggplot(data = hour11 %>% filter(windspeed<.5)) +
geom_jitter(mapping=aes(x=windspeed, y=cnt))
#RESULT: Looks to have little effect. Only drops off because there are fewer occurances of higher wind speeds.
```
####Looking at humidity variable
```{r}
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hum, y=cnt))
```
####Looking at month variable
```{r}
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt))
```
```{r}
t <- lm(cnt~hr^3, hour11)
```
hour11 <- read_csv('https://raw.githubusercontent.com/idc9/stor390/master/data/bikes_2011.csv')
ggplot(data = hour11) +
geom_boxplot(mapping = aes(x=factor(workingday), y=cnt))
is_wd <- hour11[hour11$workingday==1,]$cnt
not_wd <- hour11[!hour11$workingday==1,]$cnt
t.test(x=is_wd, y=not_wd)
ggplot(data = hour11) +
geom_boxplot(mapping = aes(x=factor(workingday), y=cnt))
ggplot(data = hour11) +
geom_boxplot(mapping = aes(x=factor(weekday), y=cnt))
workingday
ggplot(data = hour11) +
geom_boxplot(mapping = aes(x=factor(workingday), y=cnt))
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt), color=factor(workingday))
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt), color=factor(workingday))
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt), color=factor(workday))
View(hour11)
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt), color=factor(hour11$workingday))
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt), color=factor(hour11$workingday))
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt))
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt, color=workingday))
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt, color=factor(workingday)))
ggplot(data = hour11) +
geom_hex(mapping=aes(x=hr, y=cnt, color=temp))
ggplot(data = hour11) +
geom_point(mapping=aes(x=hr, y=cnt, color=temp))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=temp))
ggplot(data = hour11) +
geom_histogram(mapping=aes(x=windspeed), bins=30)
ggplot(data = hour11 %>% filter(windspeed<.5)) +
geom_jitter(mapping=aes(x=windspeed, y=cnt))
ggplot(data = hour11 %>% filter(windspeed<.5)) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=windspeed))
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=hr, y=cnt, color=factor(mnth)))
ggplot(data=hour11) +
geom_point(mapping=aes(x=hr, y=cnt, color=factor(mnth)))
ggplot(data=hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=factor(mnth)))
geom_boxplot
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=hr, y=cnt, color=factor(mnth)))
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt, color=hr)
ggplot(data=hour11) +
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt, color=hr))
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt))
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt, color=factor(hr)))
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt, color=hr))
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt))
ggplot(data=hour11) +
geom_jitter(mapping=aes(x=factor(mnth), y=cnt))
geom_boxplot
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hum, y=cnt))
---
title: "Analysis 3 EDA"
author: "Trevor Levey"
date: "11/11/2017"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# data from 2011
hour11 <- read_csv('https://raw.githubusercontent.com/idc9/stor390/master/data/bikes_2011.csv')
```
####Exploring the workingday variable
```{r}
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt, color=factor(workingday)))
is_wd <- hour11[hour11$workingday==1,]$cnt
not_wd <- hour11[!hour11$workingday==1,]$cnt
t.test(x=is_wd, y=not_wd)
```
####Looking at temp variable
```{r}
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=temp))
ggplot(data = hour11 %>% filter(cnt<200)) +
geom_jitter(mapping=aes(x=temp, y=cnt))
#RESULT: Definitely something going on. Still densest below 200
```
####Looking at wind speed variable
```{r}
ggplot(data = hour11) +
geom_histogram(mapping=aes(x=windspeed), bins=30)
ggplot(data = hour11 %>% filter(windspeed<.5)) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=windspeed))
#RESULT: Looks to have little effect. Only drops off because there are fewer occurances of higher wind speeds.
```
####Looking at humidity variable
```{r}
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hum, y=cnt))
```
####Looking at month variable
```{r}
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt))
```
```{r}
t <- lm(cnt~hr^3, hour11)
```
t.test(x=is_wd, y=not_wd)
View(hour11)
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt, color=factor(workingday)))
is_wd <- hour11[hour11$workingday==1,]$cnt
not_wd <- hour11[!hour11$workingday==1,]$cnt
t.test(x=is_wd, y=not_wd)
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt, color=factor(workingday)))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=temp))
ggplot(data = hour11 %>% filter(cnt<200)) +
geom_jitter(mapping=aes(x=temp, y=cnt))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=temp))
lm(temp~cnt) %>% summary(
)
lm(temp~cnt) %>% summary()
lm(temp~cnt, hour11) %>% summary()
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=temp))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=temp, y=cnt))
ggplot(data = hour11) +
geom_point(mapping = aes(x=hr, y=cnt, color=factor(workingday)))
not_wd <- hour11[!hour11$workingday==1,]$cnt
is_wd <- hour11[hour11$workingday==1,]$cnt
not_wd <- hour11[!hour11$workingday==1,]$cnt
t.test(x=is_wd, y=not_wd)
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=temp))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=temp, y=cnt))
ggplot(data = hour11) +
geom_histogram(mapping=aes(x=windspeed), bins=30)
ggplot(data = hour11 %>% filter(windspeed<.5)) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=windspeed))
ggplot(data = hour11 %>% filter(windspeed)) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=windspeed))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=windspeed))
ggplot(data = hour11) +
geom_jitter(mapping = aes(x=hr, y=cnt, color=factor(workingday)))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=workday, size=temp))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=workingday, size=temp))
temp
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=temp))
ggplot(data = hour11) +
geom_histogram(mapping=aes(x=windspeed), bins=30)
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=windspeed))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hum, y=cnt))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hum, y=cnt, color=workingday))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hum, y=cnt, color=factor(workingday)))
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt))
test <- hour11 %>%
group_by(mnth) %>%
summarise(mean=mean(cnt, na.rm=TRUE))
View(test)
ggplot(data=test) +
geom_smooth(mapping=aes(x=factor(mnth), y=mean))
ggplot(data=test) +
geom_line(mapping=aes(x=factor(mnth), y=mean))
ggplot(data=test) +
geom_curve(mapping=aes(x=factor(mnth), y=mean))
ggplot(data=test) +
geom_curve(mapping=aes(xend=factor(mnth), yend=mean))
ggplot(data=test) +
geom_point(mapping=aes(xend=factor(mnth), yend=mean))
ggplot(data=test) +
geom_point(mapping=aes(x=factor(mnth), y=mean))
?geom_point
ggplot(data=test) +
geom_point(mapping=aes(x=mnth, y=mean))
factor
ggplot(data=test) +
geom_point(mapping=aes(x=factor(mnth), y=mean))
test <- hour11 %>%
group_by(mnth) %>%
summarise(mean=mean(cnt, na.rm=TRUE))
ggplot(data=test) +
geom_point(mapping=aes(x=factor(mnth), y=mean))
ggplot(data=hour11) +
geom_point(mapping=aes(x=factor(mnth), y=cnt))
ggplot(data=hour11) +
geom_jitter(mapping=aes(x=factor(mnth), y=cnt))
ggplot(data=hour11) +
geom_jitter(mapping=aes(x=factor(mnth), y=cnt)) +
geom_smooth()
ggplot(data=hour11) +
geom_jitter(mapping=aes(x=factor(mnth), y=cnt)) +
geom_smooth(mapping=aes(x=factor(mnth), y=cnt))
ggplot(data=hour11) +
geom_jitter(mapping=aes(x=factor(mnth), y=cnt)) +
geom_smooth(mapping=aes(x=mnth, y=cnt))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hum, y=cnt, color=factor(workingday))) +
geom_smooth(mapping=aes(x=hum, y=cnt))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=windspeed)) +
geom_smooth(mapping=aes(x=hr, y=cnt))
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=temp, y=cnt)) +
geom_smooth(mapping=aes(x=temp, y=cnt))
ggplot(data = hour11) +
geom_jitter(mapping = aes(x=hr, y=cnt, color=factor(workingday))) +
geom_smooth(mapping=aes(x=hr, y=cnt))
hour11 %>%
group_by(weathersit) %>%
summarise(
weather_occurances=n(),
mean_bikes_rented=mean(cnt, na.rm=TRUE),
max_bikes_rented=max(cnt, na.rm=TRUE)
) %>%
View()
hour11 %>%
group_by(weathersit) %>%
summarise(
weather_occurances=n(),
mean_bikes_rented=mean(cnt, na.rm=TRUE),
max_bikes_rented=max(cnt, na.rm=TRUE),
min_bikes_rented=min(cnt, na.rm=TRUE)
) %>%
View()
hour11 %>%
group_by(weathersit) %>%
summarise(
weather_occurances=n(),
mean_bikes_rented=mean(cnt, na.rm=TRUE),
median_bikes_rented=median(cnt, na.rm=TRUE),
max_bikes_rented=max(cnt, na.rm=TRUE),
min_bikes_rented=min(cnt, na.rm=TRUE)
) %>%
View()
hour11 %>%
group_by(weathersit) %>%
summarise(
weather_occurances=n(),
mean_bikes_rented=mean(cnt, na.rm=TRUE),
median_bikes_rented=median(cnt, na.rm=TRUE)
) %>%
View()
hour11 %>%
group_by(weathersit) %>%
summarise(
weather_occurances=n(),
mean_bikes_rented=mean(cnt, na.rm=TRUE),
median_bikes_rented=median(cnt, na.rm=TRUE),
mean_casual_rentals=mean(casual, na.rm=TRUE),
mean_registered_rentals=mean(registered, na.rm=TRUE)
) %>%
View()
---
title: "Analysis 3 EDA"
author: "Trevor Levey"
date: "11/11/2017"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
# data from 2011
hour11 <- read_csv('https://raw.githubusercontent.com/idc9/stor390/master/data/bikes_2011.csv')
```
####Exploring the workingday variable
```{r}
ggplot(data = hour11) +
geom_jitter(mapping = aes(x=hr, y=cnt, color=factor(workingday))) +
geom_smooth(mapping=aes(x=hr, y=cnt))
```
```{r}
is_wd <- hour11[hour11$workingday==1,]$cnt
not_wd <- hour11[!hour11$workingday==1,]$cnt
t.test(x=is_wd, y=not_wd)
```
####Looking at temp variable
```{r}
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=temp))
```
```{r}
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=temp, y=cnt)) +
geom_smooth(mapping=aes(x=temp, y=cnt))
```
####Looking at wind speed variable
```{r}
ggplot(data = hour11) +
geom_histogram(mapping=aes(x=windspeed), bins=30)
```
```{r}
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hr, y=cnt, color=windspeed))
```
####Looking at humidity variable
```{r}
ggplot(data = hour11) +
geom_jitter(mapping=aes(x=hum, y=cnt, color=factor(workingday))) +
geom_smooth(mapping=aes(x=hum, y=cnt))
```
####Looking at weathersit variable
```{r}
hour11 %>%
group_by(weathersit) %>%
summarise(
weather_occurances=n(),
mean_bikes_rented=mean(cnt, na.rm=TRUE),
median_bikes_rented=median(cnt, na.rm=TRUE),
mean_casual_rentals=mean(casual, na.rm=TRUE),
mean_registered_rentals=mean(registered, na.rm=TRUE)
)
```
####Looking at month variable
```{r}
ggplot(data=hour11) +
geom_boxplot(mapping=aes(x=factor(mnth), y=cnt))
```
```{r}
ggplot(data=hour11) +
geom_jitter(mapping=aes(x=factor(mnth), y=cnt)) +
geom_smooth(mapping=aes(x=mnth, y=cnt))
```
shiny::runApp('*STOR320/Final Project/Shiny App')
runApp('*STOR320/Final Project/Shiny App')
runApp('*STOR320/Final Project/Shiny App')
healthcare <- read_csv("tidied_data.csv")
Covered_By_State <- read_csv("by_state.csv")
Covered_By_Region <- read_csv("by_region.csv")
Cost_By_Disease <- read_csv("by_disease.csv")
setwd("~/Desktop/Fall_2017/*STOR320/Final Project/Shiny App")
runApp()
runApp()
healthcare <- read_csv("tidied_data.csv")
Covered_By_State <- read_csv("by_state.csv")
Covered_By_Region <- read_csv("by_region.csv")
Cost_By_Disease <- read_csv("by_disease.csv")
runApp()
